---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
source("helpers.R")
source("survey.R")
```


```{r}
DisjunctiveData <- read_csv("disjunctive_or-merged.csv")
```

# Ceiling Checks

```{r}
CeilingParticipant <- DisjunctiveData %>% 
  filter(dataType == "Filler") %>% 
  mutate(response_binary = ifelse(response == "['are']",1,0)) %>% 
  group_by(cond,workerid) %>% 
  summarize(
    areRate = mean(response_binary),
    CI.Low = ci.low(response_binary),
    CI.High = ci.high(response_binary),
    tokens = n()) %>% 
  mutate(YMin = areRate - CI.Low, YMax = areRate + CI.High)
```

```{r}
CeilingParticipant %>% 
  ggplot(aes(x=reorder(cond,-areRate), y=areRate, fill=cond)) +
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  theme_bw() + 
  ylim(0,1) + 
  labs(x="Conjunct Numbers",y="Proportion of 'are' Responses", fill="Conjunct Types") + 
  scale_fill_brewer(palette = "Pastel2") + 
  # theme(legend.position = "none") + 
  # scale_x_discrete(labels=c("Singular+\nPlural","Plural+\nPlural","Plural+\nSingular","Singular+\nSingular")) +
  facet_wrap(~workerid)
```



# Main Data Analysis

```{r}
DisjunctiveProcessed <- DisjunctiveData %>% 
  filter(dataType == "Critical") %>% 
  mutate(response_binary = ifelse(response == "['are']",1,0)) %>% 
  group_by(cond) %>% 
  summarize(
    areRate = mean(response_binary),
    CI.Low = ci.low(response_binary),
    CI.High = ci.high(response_binary)
    ) %>% 
  mutate(YMin = areRate - CI.Low, YMax = areRate + CI.High)
```

```{r}
DisjunctiveProcessed %>% 
  ggplot(aes(x=reorder(cond,-areRate), y=areRate, fill=cond)) +
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  theme_bw() + 
  ylim(0,1) + 
  labs(x="Conjunct Numbers",y="Proportion of 'are' Responses", fill="Response Copula") + 
  scale_fill_brewer(palette = "Pastel2") + 
  theme(legend.position = "none")  
  # scale_x_discrete(labels=c("Singular+\nPlural","Plural+\nPlural","Plural+\nSingular","Singular+\nSingular"))
```

## Particpant-Level

```{r}
DisjunctiveParticipant <- DisjunctiveData %>% 
  filter(dataType == "Critical") %>% 
  mutate(response_binary = ifelse(response == "['are']",1,0)) %>% 
  group_by(workerid,cond) %>% 
  summarize(
    areRate = mean(response_binary),
    CI.Low = ci.low(response_binary),
    CI.High = ci.high(response_binary)
    ) %>% 
  mutate(YMin = areRate - CI.Low, YMax = areRate + CI.High)
```

```{r}
DisjunctiveParticipant %>% 
  ggplot(aes(x=reorder(cond,-areRate), y=areRate, fill=cond)) +
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  theme_bw() + 
  ylim(0,1) + 
  labs(x="Conjunct Numbers",y="Proportion of 'are' Responses", fill="Conjunct Types") + 
  scale_fill_brewer(palette = "Pastel2") + 
  # theme(legend.position = "none") + 
  # scale_x_discrete(labels=c("Singular+\nPlural","Plural+\nPlural","Plural+\nSingular","Singular+\nSingular")) +
  facet_wrap(~workerid)
```


## Extracting Demographic Information

```{r}
test <- extract_demographics(DisjunctiveData,"workerid","response")
```


### Gender

```{r}
DisjunctiveProcessedGender <- test %>% 
  filter(dataType == "Critical") %>% 
  mutate(response_binary = ifelse(response == "['are']",1,0)) %>% 
  group_by(cond,gender) %>% 
  summarize(
    areRate = mean(response_binary),
    CI.Low = ci.low(response_binary),
    CI.High = ci.high(response_binary)
    ) %>% 
  mutate(YMin = areRate - CI.Low, YMax = areRate + CI.High)
```

```{r}
DisjunctiveProcessedGender %>% 
  ggplot(aes(x=reorder(cond,-areRate), y=areRate, fill=cond)) +
  geom_bar(stat="identity") + 
  geom_errorbar(aes(ymin=YMin,ymax=YMax), width=.25) + 
  theme_bw() + 
  ylim(0,1) + 
  labs(x="Conjunct Numbers",y="Proportion of 'are' Responses", fill="Response Copula") + 
  scale_fill_brewer(palette = "Pastel2") + 
  theme(legend.position = "none") + 
  facet_wrap(~gender)
  # scale_x_discrete(labels=c("Singular+\nPlural","Plural+\nPlural","Plural+\nSingular","Singular+\nSingular"))
```
